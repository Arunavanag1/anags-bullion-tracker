---
phase: 26-mobile-radial-collage
plan: 02
type: execute
---

<objective>
Enhance the mobile collage experience with gesture-based lightbox navigation and responsive polish.

Purpose: Create a polished, gesture-driven image viewing experience that feels native to mobile.
Output: Improved ItemLightbox with swipe gestures, responsive gallery sizing, accessibility support.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

**Prior plan:**
@.planning/phases/26-mobile-radial-collage/26-01-SUMMARY.md

**Files to enhance:**
@bullion-tracker-mobile/src/screens/CollageScreen.tsx
@bullion-tracker-mobile/src/components/gallery/RadialGallery.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create gesture-based ImageLightbox component</name>
  <files>bullion-tracker-mobile/src/components/gallery/ImageLightbox.tsx</files>
  <action>
Extract and enhance lightbox into dedicated component with gesture support:

1. Props: `{ visible, item, initialImageIndex, onClose, onNext?, onPrevious? }`
2. Use react-native-gesture-handler's `PanGestureHandler` for swipe:
   - Horizontal swipe left/right: navigate images
   - Vertical swipe down: close lightbox
3. Use Reanimated for smooth transition animations:
   - `useAnimatedGestureHandler` for gesture tracking
   - `withSpring` for snap-back animations
   - Opacity fade when swiping down
4. Keep existing details panel (metal badge, title, grade, weight, value)
5. Add pinch-to-zoom on image using `PinchGestureHandler`:
   - Combine with pan for pan-while-zoomed
   - Reset zoom on image change
6. Image indicators at bottom (existing, keep)
7. Animate image transitions when navigating
  </action>
  <verify>Lightbox opens, swipe left/right navigates, swipe down closes, pinch zooms</verify>
  <done>ImageLightbox has fluid gesture navigation, pinch-to-zoom, swipe-to-dismiss</done>
</task>

<task type="auto">
  <name>Task 2: Add responsive sizing and polish</name>
  <files>bullion-tracker-mobile/src/components/gallery/RadialGallery.tsx, bullion-tracker-mobile/src/screens/CollageScreen.tsx</files>
  <action>
Polish the radial gallery for different screen sizes and edge cases:

1. **Responsive radius** in RadialGallery:
   - Use `Dimensions.get('window')` for screen size
   - Small phones (width < 375): radius 150
   - Standard phones: radius 180
   - Large phones/tablets (width > 428): radius 220
   - Listen for dimension changes with `Dimensions.addEventListener`

2. **Card sizing** based on screen:
   - Small: size='sm' (140×200)
   - Standard+: size='md' (180×250)

3. **Empty state polish** in CollageScreen:
   - Keep existing empty state but add subtle animation
   - Fade in with Reanimated entering animation

4. **Scroll height calculation**:
   - Calculate proper scroll content height for full rotation
   - Height = screen height × 2.5 (allows full scroll through both phases)

5. **Accessibility**:
   - Add accessibilityLabel to MobilePhotoCard
   - Add accessibilityRole="button" to cards
   - Add accessibilityHint describing tap action
  </action>
  <verify>Test on different simulator sizes (iPhone SE, iPhone 15, iPhone 15 Pro Max), verify scaling works</verify>
  <done>Gallery adapts to screen sizes, gestures work smoothly, accessibility labels present</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete mobile radial collage with gesture-based lightbox</what-built>
  <how-to-verify>
    1. Run: `cd bullion-tracker-mobile && npx expo start`
    2. Open on iOS Simulator or device
    3. Navigate to Collage tab
    4. Verify: Items arranged in arc formation at top of screen
    5. Scroll: Wheel rotates smoothly (clockwise then counter-clockwise)
    6. Tap item: Lightbox opens with image
    7. Swipe left/right in lightbox: Navigate between images
    8. Pinch in lightbox: Zoom in/out on image
    9. Swipe down: Dismiss lightbox
    10. Test on different size simulators
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] ImageLightbox component created with gesture handlers
- [ ] Swipe navigation works (left/right/down)
- [ ] Pinch-to-zoom functional
- [ ] Responsive sizing adapts to screen width
- [ ] Accessibility labels on interactive elements
- [ ] No TypeScript errors
- [ ] Human verification approved
</verification>

<success_criteria>

- All tasks completed
- Gesture-based lightbox feels native and responsive
- Gallery adapts to different phone sizes
- Phase 26 complete - mobile radial collage shipped
</success_criteria>

<output>
After completion, create `.planning/phases/26-mobile-radial-collage/26-02-SUMMARY.md`
</output>
