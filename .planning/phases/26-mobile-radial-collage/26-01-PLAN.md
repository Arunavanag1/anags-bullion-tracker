---
phase: 26-mobile-radial-collage
plan: 01
type: execute
---

<objective>
Create a scroll-driven radial photo gallery for the React Native mobile app, porting the web RadialScrollGallery concept to React Native using Reanimated.

Purpose: Bring the premium photo showcase experience from web to mobile, replacing the basic grid layout with an interactive rotating wheel.
Output: RadialGallery component integrated into CollageScreen with MobilePhotoCard components.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Web implementation to port:**
@bullion-tracker/src/components/gallery/RadialScrollGallery.tsx
@bullion-tracker/src/components/gallery/CollectionPhotoCard.tsx

**Current mobile implementation to replace:**
@bullion-tracker-mobile/src/screens/CollageScreen.tsx

**Mobile dependencies available:**
- react-native-reanimated ~4.1.1
- react-native-gesture-handler ~2.28.0

**Key patterns from web:**
- Items positioned on arc using trigonometry (cos/sin of angle × radius)
- Scroll-driven rotation: Phase 1 clockwise, Phase 2 counter-clockwise
- Visible arc angle ~70° with items centered at top (270°)
- Responsive radius: desktop 550px, mobile 220px
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create RadialGallery component with scroll animation</name>
  <files>bullion-tracker-mobile/src/components/gallery/RadialGallery.tsx</files>
  <action>
Create RadialGallery component using Reanimated for scroll-driven rotation:

1. Accept children as render prop: `(selectedIndex: number | null) => ReactNode[]`
2. Accept props: `radius` (default 180), `visibleArc` (default 70), `onItemSelect`
3. Use `useAnimatedScrollHandler` to track scroll position
4. Use `useSharedValue` for rotation angle
5. Position items on arc using same math as web:
   - startAngle = 270 - visibleArc/2
   - anglePerItem = visibleArc / (itemCount - 1)
   - x = cos(angle) * radius, y = sin(angle) * radius
6. Implement two-phase rotation via interpolation:
   - 0-50% scroll: clockwise (0 → maxRotation)
   - 50-100% scroll: counter-clockwise (maxRotation → 0)
7. Use `Animated.View` with `useAnimatedStyle` for rotation transform
8. Wrap in `Animated.ScrollView` with vertical scroll
9. Items positioned absolutely within rotating container

Key differences from web:
- No GSAP/ScrollTrigger - use Reanimated interpolation
- No pinning - use natural scroll with height multiplier
- Touch instead of mouse for selection
  </action>
  <verify>Component file exists and TypeScript compiles: `cd bullion-tracker-mobile && npx tsc --noEmit`</verify>
  <done>RadialGallery component renders items in arc formation, rotates on scroll</done>
</task>

<task type="auto">
  <name>Task 2: Create MobilePhotoCard component</name>
  <files>bullion-tracker-mobile/src/components/gallery/MobilePhotoCard.tsx</files>
  <action>
Create MobilePhotoCard matching web CollectionPhotoCard design:

1. Props interface: `{ item: CollectionItem, imageUrl: string, isSelected?: boolean, size?: 'sm' | 'md' }`
2. Card structure:
   - Container with rounded corners, shadow, white background
   - Image section with metal badge overlay (top-left)
   - Content section with title, grade (if exists), weight
3. Size configurations:
   - sm: 140×200, image 120px
   - md: 180×250, image 160px (default)
4. Metal badge colors from Colors.ts: gold, silver, platinum
5. Use StyleSheet for all styles (match existing mobile patterns)
6. Scale transform when isSelected for visual feedback
7. Title truncation with numberOfLines={2}
  </action>
  <verify>Component renders with mock data, badge shows correct metal color</verify>
  <done>MobilePhotoCard displays item image, metal badge, title, weight, and grade</done>
</task>

<task type="auto">
  <name>Task 3: Integrate RadialGallery into CollageScreen</name>
  <files>bullion-tracker-mobile/src/screens/CollageScreen.tsx</files>
  <action>
Replace grid layout with RadialGallery:

1. Import RadialGallery and MobilePhotoCard
2. Remove grid rendering logic (lines ~130-148)
3. Add RadialGallery component:
   ```tsx
   <RadialGallery
     radius={180}
     onItemSelect={(index) => openLightbox(items[index], 0)}
   >
     {(selectedIndex) =>
       items.map((item, index) => (
         <MobilePhotoCard
           key={item.id}
           item={item}
           imageUrl={item.images?.[0] || ''}
           isSelected={selectedIndex === index}
         />
       ))
     }
   </RadialGallery>
   ```
4. Keep existing: spot price banner, empty state, lightbox modal, tab bar
5. Adjust scroll container to accommodate radial gallery height
6. Keep loadData and refresh logic unchanged
7. Update allImages logic to work with items (not flattened images)
  </action>
  <verify>Run app on simulator: `cd bullion-tracker-mobile && npx expo start`, navigate to Collage tab, verify radial layout renders</verify>
  <done>CollageScreen shows radial gallery instead of grid, items rotate on scroll, tap opens lightbox</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes in bullion-tracker-mobile
- [ ] App runs without crashes on iOS simulator
- [ ] Collage screen shows items in radial arc formation
- [ ] Scrolling causes wheel to rotate smoothly
- [ ] Tapping item opens existing lightbox modal
- [ ] Metal badges display correct colors
</verification>

<success_criteria>

- RadialGallery component created with scroll-driven rotation
- MobilePhotoCard matches web design patterns
- CollageScreen uses radial layout instead of grid
- Scroll animation is smooth (60fps target)
- Existing lightbox still functions
</success_criteria>

<output>
After completion, create `.planning/phases/26-mobile-radial-collage/26-01-SUMMARY.md`
</output>
