# Phase 25 Plan 01: Unified Portfolio Display

## Objective

Remove the spot/book value toggle and show a single unified portfolio value. Bullion items use spot + premium (default 0%), numismatic items use guide price or custom value.

## Current State

- Mobile DashboardScreen has "Spot Value" / "Book Value" toggle (lines 191-202)
- Web CollectionSummary shows both "Total Melt Value" and "Total Book Value" side by side
- `calculatePortfolioSummary` returns both `totalMeltValue` and `totalBookValue`
- ValuationMethod type exists: `'spot' | 'book'`
- Mobile persists valuation method preference in AsyncStorage

## Target State

- Single "Portfolio Value" displayed (no toggle needed)
- Value calculation:
  - Bullion (spot_premium): `spot × weight × quantity × (1 + premiumPercent/100)` (default 0% if not set)
  - Numismatic (guide_price): uses `numismaticValue` field
  - Custom: uses `customBookValue` field
- This is effectively the current "Book Value" calculation, but unified as the single source of truth

## Tasks

### Task 1: Update Web CollectionSummary to Show Unified Value

**Files:**
- `bullion-tracker/src/components/collection/CollectionSummary.tsx`

**Changes:**
1. Replace the 3-column grid (Holdings, Melt Value, Book Value) with 2-column (Holdings, Portfolio Value)
2. Remove "Total Melt Value" section
3. Rename "Total Book Value" to "Portfolio Value"
4. Keep the "vs melt" percentage comparison below as useful context

### Task 2: Update Mobile DashboardScreen to Remove Toggle

**Files:**
- `bullion-tracker-mobile/src/screens/DashboardScreen.tsx`
- `bullion-tracker-mobile/src/lib/settings.ts` (optional cleanup)
- `bullion-tracker-mobile/src/types/index.ts` (optional cleanup)

**Changes:**
1. Remove ToggleButton component and toggle UI (lines 191-202)
2. Remove `valuationMethod` state and related handlers
3. Always use `summary.totalBookValue` for portfolio value display
4. Update hero label from "PORTFOLIO VALUE" toggle behavior to static display
5. Keep daily gain tracking using book value
6. Optionally remove ValuationMethod type if no longer used elsewhere

### Task 3: Update Mobile Calculations to Default Premium

**Files:**
- `bullion-tracker-mobile/src/lib/calculations.ts`

**Changes:**
1. Ensure `calculatePortfolioSummary` uses 0% premium default for bullion items without premiumPercent set
2. Verify totalBookValue calculation matches expected: bullion uses spot+premium, numismatic uses numismaticValue

### Task 4: Verify Web Calculations Match

**Files:**
- `bullion-tracker/src/lib/calculations.ts`

**Changes:**
1. Audit `calculateBookValue` function to ensure bullion defaults to 0% premium
2. Verify numismatic items use numismaticValue (guide_price) correctly

## Verification

1. Web: CollectionSummary shows single "Portfolio Value" without melt/book choice
2. Mobile: DashboardScreen shows single "Portfolio Value" without toggle
3. Values match between web and mobile for same data
4. Bullion with no premium shows spot value (0% premium = melt value)
5. Bullion with premium shows adjusted value
6. Numismatic shows guide price value
7. Daily gain tracking still works on mobile

## Risks

- Low risk: This is primarily UI simplification
- The underlying calculation logic is already in place (totalBookValue)
- Main change is removing the toggle and melt value display

## Time Estimate

~30 minutes
