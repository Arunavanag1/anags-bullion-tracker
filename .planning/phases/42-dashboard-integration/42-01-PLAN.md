---
phase: 42-dashboard-integration
plan: 01
type: execute
---

<objective>
Finalize chart integration in mobile dashboard with proper layout, all three charts, and consistent styling.

Purpose: Complete the v2.0 Mobile Charts milestone with polished dashboard experience.
Output: Dashboard with Portfolio Line Chart, Allocation Pie Chart, and Gain/Loss Bar Chart in organized sections.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/41-chart-interactions/41-01-SUMMARY.md

**Relevant source files:**
@bullion-tracker-mobile/src/screens/DashboardScreen.tsx
@bullion-tracker-mobile/src/components/charts/PortfolioLineChart.tsx
@bullion-tracker-mobile/src/components/charts/AllocationPieChart.tsx
@bullion-tracker-mobile/src/components/charts/GainLossBarChart.tsx
@bullion-tracker-mobile/src/components/charts/index.ts

**Current state (from Phase 41):**
- PortfolioLineChart and AllocationPieChart already added to dashboard for testing
- GainLossBarChart exists but not integrated
- Basic "CHARTS" section header added
- Charts render but layout needs polish

**Dashboard sections (current order):**
1. Spot Price Banner
2. User Header
3. Portfolio Value Card
4. Allocation Card (simple bar)
5. Category Breakdown Card
6. Valuation Breakdown Card
7. Top Performers
8. Charts Section (added in Phase 41)

**Scope decisions:**
- Add GainLossBarChart to complete the trio
- Better spacing between charts
- Consider removing redundant Allocation Card (pie chart shows same data better)
- Keep charts at bottom in scrollable section
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add GainLossBarChart and organize chart section</name>
  <files>bullion-tracker-mobile/src/screens/DashboardScreen.tsx</files>
  <action>
Update DashboardScreen to include GainLossBarChart and improve chart section layout:

1. Add GainLossBarChart to import:
```typescript
import { PortfolioLineChart, AllocationPieChart, GainLossBarChart } from '../components/charts';
```

2. Update charts section with all three charts and proper spacing:
```typescript
{/* Charts Section */}
<View style={styles.chartsSection}>
  <Text style={styles.chartsSectionTitle}>ANALYTICS</Text>

  {/* Portfolio Value Over Time */}
  <PortfolioLineChart />

  <View style={styles.chartSpacer} />

  {/* Allocation Breakdown */}
  {spotPrices && (
    <AllocationPieChart collection={items} spotPrices={spotPrices} />
  )}

  <View style={styles.chartSpacer} />

  {/* Gain/Loss by Metal */}
  {spotPrices && (
    <GainLossBarChart collection={items} spotPrices={spotPrices} />
  )}
</View>
```

3. Add chartSpacer style:
```typescript
chartSpacer: {
  height: 24,
},
```

4. Rename section title from "CHARTS" to "ANALYTICS" for better clarity
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>All three charts render in dashboard with proper spacing</done>
</task>

<task type="auto">
  <name>Task 2: Remove redundant Allocation Card</name>
  <files>bullion-tracker-mobile/src/screens/DashboardScreen.tsx</files>
  <action>
The simple Allocation bar is now redundant since AllocationPieChart shows the same data with more detail. Remove it:

1. Delete the entire Allocation Card section (lines ~242-288):
```typescript
{/* Allocation Card */}
{summary && summary.totalMeltValue > 0 && (
  <View style={styles.allocationCard}>
    ...
  </View>
)}
```

2. Remove associated styles:
- allocationCard
- allocationLabel
- allocationBar
- allocationLegend
- legendItem (keep if used elsewhere)
- legendDot (keep if used elsewhere)
- legendText
- legendPct

Note: Check if legendItem/legendDot/legendText are used elsewhere before removing.
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>Redundant allocation card removed, dashboard is cleaner</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete dashboard with all three charts and cleaner layout</what-built>
  <how-to-verify>
    1. Run: cd bullion-tracker-mobile && npx expo start
    2. Open app on device/simulator
    3. Scroll down on dashboard to see ANALYTICS section
    4. Verify all three charts render:
       - Portfolio Line Chart with time range selector
       - Allocation Pie Chart with metal/category toggle
       - Gain/Loss Bar Chart with horizontal bars
    5. Verify charts have proper spacing between them
    6. Verify old simple allocation bar is gone
    7. Test chart interactions still work (touch on line chart, tap legend on pie chart)
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] npx tsc --noEmit passes
- [ ] All three charts visible in dashboard
- [ ] Charts have consistent spacing
- [ ] Old allocation card removed
- [ ] No console errors
- [ ] Interactions still work
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Dashboard looks polished with analytics section
- v2.0 Mobile Charts milestone ready to ship
</success_criteria>

<output>
After completion, create `.planning/phases/42-dashboard-integration/42-01-SUMMARY.md`:

# Phase 42 Plan 01: Dashboard Integration Summary

**[Substantive one-liner about what shipped]**

## Accomplishments

- Added GainLossBarChart to complete chart trio
- Organized charts in ANALYTICS section with proper spacing
- Removed redundant allocation bar card

## Files Created/Modified

- `bullion-tracker-mobile/src/screens/DashboardScreen.tsx` - Final chart integration

## Decisions Made

[Document any decisions]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

v2.0 Mobile Charts milestone COMPLETE - All charts integrated with interactions
</output>
